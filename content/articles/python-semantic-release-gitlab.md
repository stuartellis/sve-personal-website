+++
title = "Python Semantic Release with GitLab"
slug = "python-semantic-release-gitlab"
date = "2025-12-30T00:53:00+00:00"
description = "Python Semantic Release with GitLab"
draft = true
categories = ["programming", "python"]
tags = ["automation", "python"]
+++

[Python Semantic Release](https://python-semantic-release.readthedocs.io/en/stable/) enables you to automate the release of Python projects. By default, it assumes that you are hosting your project on GitHub.

## Set Up

To use Python Semantic Release with GitLab, you will need:

- A Personal Access Token with the appropriate permissions
- A GitLab project with _Allow Git push requests to the repository_ enabled in _Settings > CI/CD > Job token permissions_.
- A `.gitlab-ci.yml` file in the root directory of the project. See below for an example.
- A `releaserc.toml` file in the root directory of the project. See below for an example.

> Avoid using a `pyproject.toml` file to configure Python Semantic Release. It can significantly extend the length of this file.

## Using Personal Access Tokens

Python Semantic Release must use a token that has a Maintainer role and these permissions:

- api
- read_repository
- write_repository

Register this token as a CI variable with the name _GITLAB_TOKEN_. Set the variable as _Protected_, _Masked_ and _Expanded_.

## Example .gitlab-ci.yml for GitLab

This `.gitlab-ci.yml` file runs Python Semantic Release:

```yaml
---
stages:
  - release

variables:
  PIP_CACHE_DIR: $CI_PROJECT_DIR/.cache/pip
  PIP_ROOT_USER_ACTION: ignore

semantic-release:
  stage: release
  image: python:3.14-slim-trixie

  variables:
    GIT_STRATEGY: clone
    GIT_DEPTH: 0
    GIT_AUTHOR_NAME: "GitLab CI"
    GIT_AUTHOR_EMAIL: "$GITLAB_USER_EMAIL"
    GIT_COMMITTER_NAME: "GitLab CI"
    GIT_COMMITTER_EMAIL: "$GITLAB_USER_EMAIL"

  before_script:
    - apt-get -qy update
    - apt-get install -qy git
    - pip install python-semantic-release==10.5.3
    - git config --global user.name "GitLab CI"
    - git config --global user.email "$GITLAB_USER_EMAIL"
    - git checkout -B "$CI_COMMIT_REF_NAME"

  script:
    - semantic-release -c releaserc.toml version --print
    - semantic-release -c releaserc.toml version
    - semantic-release -c releaserc.toml changelog
    - semantic-release -c releaserc.toml publish

  cache:
    paths:
      - ${PIP_CACHE_DIR}

  rules:
    - if: '$CI_COMMIT_BRANCH == "main" && $CI_PIPELINE_SOURCE == "push"'
      when: on_success
```

## Example releaserc.toml for GitLab

This `releaserc.toml` file provides a configuration for Python Semantic Release:

```toml
[semantic_release]
assets = []
build_command_env = []
commit_message = "{version}\n\nAutomatically generated by python-semantic-release"
commit_parser = "conventional"
logging_use_named_masks = false
major_on_zero = true
allow_zero_version = false
no_git_verify = false
tag_format = "v{version}"
add_partial_tags = false

[semantic_release.branches.main]
match = "(main|master)"
prerelease_token = "rc"
prerelease = false

[semantic_release.changelog]
exclude_commit_patterns = []
mode = "update"
insertion_flag = "<!-- version list -->"
template_dir = "templates"

[semantic_release.changelog.default_templates]
changelog_file = "CHANGELOG.md"
output_format = "md"
mask_initial_release = true

[semantic_release.changelog.environment]
block_start_string = "{%"
block_end_string = "%}"
variable_start_string = "{{"
variable_end_string = "}}"
comment_start_string = "{#"
comment_end_string = "#}"
trim_blocks = false
lstrip_blocks = false
newline_sequence = "\n"
keep_trailing_newline = false
extensions = []
autoescape = false

[semantic_release.commit_author]
env = "GIT_COMMIT_AUTHOR"
default = "semantic-release <semantic-release>"

[semantic_release.commit_parser_options]
minor_tags = ["feat"]
patch_tags = ["fix", "perf"]
other_allowed_tags = ["build", "chore", "ci", "docs", "style", "refactor", "test"]
allowed_tags = ["feat", "fix", "perf", "build", "chore", "ci", "docs", "style", "refactor", "test"]
default_bump_level = 0
parse_squash_commits = true
ignore_merge_commits = true

[semantic_release.remote]
name = "origin"
type = "gitlab"
ignore_token_for_push = true
insecure = false

[semantic_release.publish]
dist_glob_patterns = ["dist/*"]
upload_to_vcs_release = true
```
